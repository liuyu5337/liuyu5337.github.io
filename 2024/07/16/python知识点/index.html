

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="zhq">
  <meta name="keywords" content="">
  
    <meta name="description" content="Python函数的参数  python函数的主要参数类型有：默认参数、关键字参数（位置参数）、不定长参数。 默认参数 1234567891011# -*- coding: UTF-8 -*-def func( a , b , c &#x3D; 0 ):    # 打印参数    print(&#x27;参数a：&#123;&#125;&#x27;.format(a) , end &#x3D; &#x27; &amp;#x27">
<meta property="og:type" content="article">
<meta property="og:title" content="python知识点">
<meta property="og:url" content="http://liuyu5337.github.io/2024/07/16/python%E7%9F%A5%E8%AF%86%E7%82%B9/index.html">
<meta property="og:site_name" content="零壹网络">
<meta property="og:description" content="Python函数的参数  python函数的主要参数类型有：默认参数、关键字参数（位置参数）、不定长参数。 默认参数 1234567891011# -*- coding: UTF-8 -*-def func( a , b , c &#x3D; 0 ):    # 打印参数    print(&#x27;参数a：&#123;&#125;&#x27;.format(a) , end &#x3D; &#x27; &amp;#x27">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-07-16T13:17:00.000Z">
<meta property="article:modified_time" content="2024-07-17T10:47:07.086Z">
<meta property="article:author" content="zhq">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>python知识点 - 零壹网络</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"liuyu5337.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>零壹网络</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="python知识点"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-07-16 21:17" pubdate>
          2024年7月16日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          75 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">python知识点</h1>
            
            
              <div class="markdown-body">
                
                <h3 id="python函数的参数">Python函数的参数</h3>
<hr />
<p>python函数的主要参数类型有：默认参数、关键字参数（位置参数）、不定长参数。</p>
<h5 id="默认参数">默认参数</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"> a , b , c = <span class="hljs-number">0</span> </span>):<br>    <span class="hljs-comment"># 打印参数</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数a：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(a) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数b：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(b) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数c：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c))<br>    <span class="hljs-keyword">return</span>;<br><br><span class="hljs-comment"># 调用 func 函数</span><br>func( <span class="hljs-string">&#x27;a&#x27;</span> , <span class="hljs-number">10</span> , <span class="hljs-number">12</span>)<br>func( <span class="hljs-string">&#x27;b&#x27;</span> , <span class="hljs-number">100</span> )<br></code></pre></td></tr></table></figure>
<p>输出：</p>
<blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">&gt;参数<span class="hljs-selector-tag">a</span>：<span class="hljs-selector-tag">a</span> 参数<span class="hljs-selector-tag">b</span>：<span class="hljs-number">10</span> 参数c：<span class="hljs-number">12</span><br>&gt;参数<span class="hljs-selector-tag">a</span>：<span class="hljs-selector-tag">b</span> 参数<span class="hljs-selector-tag">b</span>：<span class="hljs-number">100</span> 参数c：<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>当设置了默认参数的时候，在调用函数的时候，不传该参数，就会使用默认值</p>
<p><strong>只有在形参表末尾的那些参数可以有默认参数值</strong>，def
func(a, b=1) 是有效的，但是 def func(a=1, b) 是 无效 的。</p>
<p>如果想判断默认参数有没有值传递进来，可以这样设置参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br>_no_value =<span class="hljs-built_in">object</span>()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"> a , b = _no_value </span>):<br>    <span class="hljs-keyword">if</span> b <span class="hljs-keyword">is</span> _no_value :<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;b 没有赋值&#x27;</span>)<br>    <span class="hljs-keyword">return</span>;<br>func(<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure>
<p>输出:</p>
<blockquote>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">&gt;<span class="hljs-keyword">b</span> 没有赋值<br></code></pre></td></tr></table></figure>
</blockquote>
<h5 id="关键字参数位置参数">关键字参数（位置参数）</h5>
<p>一般情况下，给函数传参的时候，是按照顺序传递参数的，如果不对应顺序，就会传错值。</p>
<p>不过在 Python
中，可以通过参数名来给函数传递参数，而不用关心参数列表定义时的顺序，这被称之为关键字参数。</p>
<p>使用关键参数有两个优势 ：</p>
<ul>
<li>由于我们不必担心参数的顺序，使用函数变得更加简单了。</li>
<li>假设其他参数都有默认值，我们可以只给我们想要的那些参数赋值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"> a , b , c = <span class="hljs-number">0</span> </span>):<br>    <span class="hljs-comment"># 打印参数</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数a：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(a) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数b：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(b) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数c：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c))<br>    <span class="hljs-keyword">return</span>;<br><br><span class="hljs-comment"># 调用 func 函数</span><br>func( a=<span class="hljs-string">&#x27;a&#x27;</span> , b=<span class="hljs-number">10</span> , c=<span class="hljs-number">12</span>)<br>func( a=<span class="hljs-string">&#x27;b&#x27;</span> , c=<span class="hljs-number">100</span>, b=<span class="hljs-number">1000</span> )<br></code></pre></td></tr></table></figure>
<p>输出：</p>
<blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">&gt;参数<span class="hljs-selector-tag">a</span>：<span class="hljs-selector-tag">a</span> 参数<span class="hljs-selector-tag">b</span>：<span class="hljs-number">10</span> 参数c：<span class="hljs-number">12</span><br>&gt;参数<span class="hljs-selector-tag">a</span>：<span class="hljs-selector-tag">b</span> 参数<span class="hljs-selector-tag">b</span>：<span class="hljs-number">1000</span> 参数c：<span class="hljs-number">100</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>从输出结果看，在第二次调用的时候，即使用 func( a='b' , c=100, b=1000
) 也可以把参数传递到函数执行体。</p>
<h5 id="不定长参数">不定长参数</h5>
<p>有些时候，在设计函数的时候，无法确定传入的参数个数。这种情况下，就可以使用不定长参数。</p>
<p>Python
提供了一种元组的方式来接受没有直接定义的参数。这种方式在参数前边加星号
<code>*</code> 。</p>
<p>如果在函数调用时没有指定参数，它就是一个空元组。我们也可以不向函数传递未命名的变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"> a , b , c=<span class="hljs-number">0</span>, *args</span>):<br>    <span class="hljs-comment"># 打印参数</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数a：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(a) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数b：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(b) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数c：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数args：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(args))<br>    <span class="hljs-keyword">return</span>;<br><br><span class="hljs-comment"># 调用 func 函数</span><br>func( <span class="hljs-string">&#x27;a&#x27;</span> , <span class="hljs-number">10</span> , <span class="hljs-number">12</span>, <span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;345&quot;</span>,<span class="hljs-number">789</span>)<br>func( a=<span class="hljs-string">&#x27;b&#x27;</span> , c=<span class="hljs-number">100</span>, b=<span class="hljs-number">1000</span> )<br></code></pre></td></tr></table></figure>
<p>输出:</p>
<blockquote>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs less">&gt;参数<span class="hljs-selector-tag">a</span>：<span class="hljs-selector-tag">a</span> 参数<span class="hljs-selector-tag">b</span>：<span class="hljs-number">10</span> 参数<span class="hljs-selector-tag">c</span>：<span class="hljs-number">12</span><br>&gt;参数<span class="hljs-selector-tag">args</span>：(<span class="hljs-string">&#x27;123&#x27;</span>, <span class="hljs-string">&#x27;345&#x27;</span>, <span class="hljs-number">789</span>)<br>&gt;参数<span class="hljs-selector-tag">a</span>：<span class="hljs-selector-tag">b</span> 参数<span class="hljs-selector-tag">b</span>：<span class="hljs-number">1000</span> 参数<span class="hljs-selector-tag">c</span>：<span class="hljs-number">100</span><br>&gt;参数<span class="hljs-selector-tag">args</span>：()<br></code></pre></td></tr></table></figure>
</blockquote>
<p>如果需要传不定长的参数<code>*args</code>，那么就不要使用位置参数传递，否则会报错。如果需要通过位置参数的方式传递不定长参数，就需要用<code>**args</code>的方式。使用方式如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"> a , b , c=<span class="hljs-number">0</span>, **args</span>):<br>    <span class="hljs-comment"># 打印参数</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数a：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(a) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数b：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(b) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数c：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数args：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(args))<br>    <span class="hljs-keyword">return</span>;<br><br><span class="hljs-comment"># 调用 func 函数</span><br>func( a=<span class="hljs-string">&#x27;a&#x27;</span> , b=<span class="hljs-number">10</span> , c=<span class="hljs-number">12</span>, args=(<span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;345&quot;</span>,<span class="hljs-number">789</span>))<br>func( a=<span class="hljs-string">&#x27;b&#x27;</span> , c=<span class="hljs-number">100</span>, b=<span class="hljs-number">1000</span> )<br></code></pre></td></tr></table></figure>
<p>输出：</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">参数a：a 参数b：10 参数c：12</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">参数args：&#123;<span class="hljs-string">&#x27;args&#x27;</span>: (<span class="hljs-string">&#x27;123&#x27;</span>, <span class="hljs-string">&#x27;345&#x27;</span>, 789)&#125;</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">参数a：b 参数b：1000 参数c：100</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">参数args：&#123;&#125;</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>通过对比两个例子，可以知道，<code>*args</code>是可变参数，且
args其实就是一个 tuple （元组），<code>**args</code>是关键字参数，且
args 就是一个 dict （字典）</p>
<h5 id="只接受关键字参数">只接受关键字参数</h5>
<p>关键字参数使用简单，不容易出错，如果希望某些参数强制使用关键字参数传递，这时候该怎么办呢？</p>
<p>将强制关键字参数放到某个<code>*</code>参数或者单个<code>*</code>后面就能达到这种效果,比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"> a , *, b , c=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-comment"># 打印参数</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数a：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(a) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数b：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(b) , end = <span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;参数c：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c))<br>    <span class="hljs-keyword">return</span>;<br><br><span class="hljs-comment"># 调用 func 函数</span><br>func( a=<span class="hljs-string">&#x27;a&#x27;</span> , b=<span class="hljs-number">10</span> , c=<span class="hljs-number">12</span>)<br></code></pre></td></tr></table></figure>
<p>在这个代码中，函数的参数中，在参数<code>a</code>的后面加了<code>*</code>,
那么参数<code>b</code>和参数<code>c</code>就要使用关键字参数。否则就会报错。</p>
<p>func( 'a' , 10 ) 或者 func( 'a' , b=10,100) 这样的传参调用就会报错，
func( 'a' , b=10 ) 或者 func( a='a' , b=10,c=a00 )则没有问题。</p>
<p>原因就在于 *
之后的参数必须用关键字参数传递，如果最后一个有默认值则可以不传递。</p>
<h3 id="类与对象">类与对象</h3>
<hr />
<p>面向对象有两个基本的概念，分别是类和对象。面向对象的编程语言，也有三大特性，继承，多态和封装性。</p>
<h5 id="新式类与旧式类经典类">新式类与旧式类（经典类）</h5>
<p>Python2.x中，默认都是经典类，只有显式继承了object的才是新式类，即：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">Person</span>(<span class="hljs-symbol">object</span>):<span class="hljs-symbol">pass</span>    新式类<br><span class="hljs-symbol">class</span> <span class="hljs-symbol">Person</span>():<span class="hljs-symbol">pass</span>    经典类<br></code></pre></td></tr></table></figure>
<p>在<a
target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Python&amp;spm=1001.2101.3001.7020">Python</a>
3.x中取消了经典类，默认都是新式类，并且不必显式的继承object，也就是说：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">Person</span>(<span class="hljs-symbol">object</span>):<span class="hljs-symbol">pass</span>    新式类<br><span class="hljs-symbol">class</span> <span class="hljs-symbol">Person</span>():<span class="hljs-symbol">pass</span>     新式类<br></code></pre></td></tr></table></figure>
<p><code>新式类</code>和<code>经典类（旧式类）</code>的<code>区别</code>的在于<code>子类多继承</code>的情况下，<code>经典类</code>多继承搜索顺序是<code>深度优先</code>，<code>新式类</code>多继承搜索顺序是<code>广度优先</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#这里基类Person显式的继承了object</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello, I&#x27;m Person.&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Man</span>(<span class="hljs-title class_ inherited__">Person</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">self</span>):<br>    		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello, I&#x27;m Man.&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Woman</span>(<span class="hljs-title class_ inherited__">Person</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello, I&#x27;m Woman.&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span>(Man,Woman):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>child = Child()<br>child.say_hello()<br></code></pre></td></tr></table></figure>
<p>输出：</p>
<blockquote>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">&gt;Hello, I<span class="hljs-symbol">&#x27;m</span> Man.<br></code></pre></td></tr></table></figure>
</blockquote>
<p>如果注释掉 Man的say_hello方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#这里基类Person显式的继承了object</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello, I&#x27;m Person.&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Man</span>(<span class="hljs-title class_ inherited__">Person</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-comment"># def say_hello(self):</span><br>    <span class="hljs-comment">#     print(&quot;Hello, I&#x27;m Man.&quot;)</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Woman</span>(<span class="hljs-title class_ inherited__">Person</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello, I&#x27;m Woman.&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span>(Man,Woman):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>child = Child()<br>child.say_hello()<br><br></code></pre></td></tr></table></figure>
<p>输出:</p>
<blockquote>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">&gt;Hello, I<span class="hljs-symbol">&#x27;m</span> Woman.<br></code></pre></td></tr></table></figure>
</blockquote>
<p>child继承了Man和Woman两个类，新式类机制下，child先调用man的say_hello方法，如果man没有该方法，则调用Woman下的say_hello方法，是广度优先调用策略。如果是深度优先，child会优先调用man的say_hello
方法，如果没有，然后会调用man的父类的方法。</p>
<h5 id="调用类的属性和方法">调用类的属性和方法</h5>
<p>类里面定义的变量是属性，类里面定义的函数是方法。</p>
<p>调用格式：类.变量 、 类.方法</p>
<h5 id="类方法">类方法</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassA</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    a = <span class="hljs-number">1</span><br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">funcA</span>(<span class="hljs-params">cls</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,cls.a)<br>        <br>    <span class="hljs-comment">#def funcB():</span><br>    <span class="hljs-comment">#    print(&quot;a=&quot;,a) #无法调用类属性</span><br>        <br>obj = ClassA()<br>obj.funcA()<br>ClassA.funcA()<br></code></pre></td></tr></table></figure>
<p>类方法调用类属性，需要以下步骤：</p>
<ul>
<li>在方法上面，用 <code>@classmethod</code>
声明该方法是类方法。只有声明了是类方法，才能使用类属性</li>
<li>类方法想要使用类属性，在第一个参数中，需要写上 <code>cls</code> ,
cls 是 class
的缩写，其实意思就是把这个类作为参数，传给自己，这样就可以使用类属性了。</li>
<li>类属性的使用方式就是 <code>cls.变量名</code></li>
</ul>
<p>无论是 <code>@classmethod</code> 还是 <code>cls</code>
,都是不能省去的。</p>
<h5 id="增加和修改类的属性">增加和修改类的属性</h5>
<p>有两种方法可以修改和增加类的属性，在类的内部和类的外部</p>
<p>类的内外部部修改、添加属性：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassA</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    a = <span class="hljs-number">1</span><br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">cls</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,cls.a)<br>        cls.a = <span class="hljs-number">3</span> <span class="hljs-comment">#内部修改属性</span><br>        cls.b = <span class="hljs-number">2</span> <span class="hljs-comment">#内部添加属性 </span><br>        <br>obj = ClassA()<br>obj.func()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;内部修改后 a =&quot;</span>, ClassA.a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;内部添加 b =&quot;</span>, ClassA.b)<br><br>ClassA.a = <span class="hljs-number">4</span> <span class="hljs-comment">#外部修改属性</span><br>ClassA.c = <span class="hljs-number">5</span> <span class="hljs-comment">#外部添加属性</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;外部修改后 a =&quot;</span>, ClassA.a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;外部添加 c =&quot;</span>, ClassA.c)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,obj.a,<span class="hljs-string">&quot;b=&quot;</span>,obj.b,<span class="hljs-string">&quot;c=&quot;</span>,obj.c)<br></code></pre></td></tr></table></figure>
<p>输出:</p>
<blockquote>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&gt;a<span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>&gt;内部修改后 a <span class="hljs-operator">=</span> <span class="hljs-number">3</span><br>&gt;内部添加 b <span class="hljs-operator">=</span> <span class="hljs-number">2</span><br>&gt;外部修改后 a <span class="hljs-operator">=</span> <span class="hljs-number">4</span><br>&gt;外部添加 c <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br>&gt;a<span class="hljs-operator">=</span> <span class="hljs-number">4</span> b<span class="hljs-operator">=</span> <span class="hljs-number">2</span> c<span class="hljs-operator">=</span> <span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>
</blockquote>
<h5
id="类属性与实例属性类方法与实例方法">类属性与实例属性、类方法与实例方法</h5>
<p>先说结论：</p>
<blockquote>
<p><strong>类属性改变了，实例属性会跟着改变。</strong>
<strong>实例属性改变了，类属性不会改变</strong>。</p>
<p><strong>类方法改变了，实例方法会跟着改变。</strong>
<strong>实例方法改变了，类方法不会改变(会报错)。</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassA</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    a = <span class="hljs-number">1</span><br><br>    <span class="hljs-comment">#类方法</span><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">cls</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,cls.a)<br>    <span class="hljs-comment">#实例方法</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;func1 a=&quot;</span>, self.a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func2</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;func2&quot;</span>)<br>        <br>obj = ClassA()<br>obj.func()<br>obj.func1()<br><span class="hljs-comment"># obj.func2() #报错</span><br><br>ClassA.func()<br><span class="hljs-comment"># ClassA.func1() #报错</span><br>ClassA.func2()<br></code></pre></td></tr></table></figure>
<p>类属性与实例属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassA</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    a = <span class="hljs-number">1</span><br><br>    <span class="hljs-comment">#类方法</span><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">cls</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,cls.a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;func1 a=&quot;</span>, self.a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func2</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;func2&quot;</span>)<br>        <br>obj = ClassA()<br>obj.func()<br>obj.func1()<br><span class="hljs-comment"># obj.func2() #报错</span><br><br>ClassA.func()<br><span class="hljs-comment"># ClassA.func1() #报错</span><br>ClassA.func2()<br><br>ClassA.a = <span class="hljs-number">3</span> <span class="hljs-comment">#修改类属性</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;类属性修改为：&quot;</span>,ClassA.a) <span class="hljs-comment">#实例属性由1 改为 3</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;实例属性修改为：&quot;</span>,obj.a) <span class="hljs-comment">#实例属性由1 改为 3</span><br>obj.a = <span class="hljs-number">4</span> <span class="hljs-comment"># 修改实例属性为4</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;实例属性修改为：&quot;</span>, obj.a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;类属性：&quot;</span>, ClassA.a) <span class="hljs-comment">#修改实例属性，类属性不变</span><br></code></pre></td></tr></table></figure>
<p>输出</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">a= 1</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">func1 a= 1</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">a= 1</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">func2</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">类属性修改为： 3</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">实例属性修改为： 3</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">实例属性修改为： 4</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">类属性： 3</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>类方法与实例方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassA</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    a = <span class="hljs-number">1</span><br><br>    <span class="hljs-comment">#类方法</span><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">cls</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a=&quot;</span>,cls.a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;func1 a=&quot;</span>, self.a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func3</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;func3&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">func2</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;func2&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">newfunc</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;这是新方法&quot;</span>)<br>        <br>obj = ClassA()<br>obj.func()<br>obj.func1()<br><span class="hljs-comment"># obj.func2() #报错</span><br><br>ClassA.func()<br><span class="hljs-comment"># ClassA.func1() #报错</span><br>ClassA.func2()<br><br>ClassA.func1 = newfunc <span class="hljs-comment">#修改类的方法</span><br>obj.func1() <span class="hljs-comment"># 实例方法改变</span><br><br>obj.func3 = newfunc<br>obj.func3()  <span class="hljs-comment">#会报错</span><br></code></pre></td></tr></table></figure>
<p>输出:</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">a= 1</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">func1 a= 1</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">a= 1</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">func2</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">这是新方法</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">---------------------------------------------------------------------------</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">TypeError                                 Traceback (most recent call last)</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">Cell In[101], line 34</span><br>    31 obj.func1() # 实例方法改变<br>    33 obj.func3 = newfunc<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">---&gt; 34 obj.func3()  <span class="hljs-comment">#会报错</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">TypeError: newfunc() missing 1 required positional argument: <span class="hljs-string">&#x27;self&#x27;</span></span><br></code></pre></td></tr></table></figure>
</blockquote>
<h5 id="类中的函数">类中的函数</h5>
<p>构造函数（初始化函数），在创建实例的时候会自动调用
<code>__init__(self)</code></p>
<p>析构函数:当销毁一个实例对象的时候，会自动调用
<code>__del__(self)</code></p>
<h5 id="类的继承重写">类的继承、重写</h5>
<p>Python支持多继承，格式如下所示，如果是单独定义的一个类，也建议继承object，因为object是一切类的基类。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span>(Base1,Base2,Base3):<br>    &lt;statement-<span class="hljs-number">1</span>&gt;<br>    .<br>    .<br>    .<br>    &lt;statement-N&gt;<br></code></pre></td></tr></table></figure>
<p>类的重写</p>
<p>子类在继承父类的情况下，如果子类没有定义自己的构造函数<code>__init__</code>，也会调用父类的构造函数<code>__init__</code>，如果定义了构造函数<code>__init__</code>,
就是重写了父类的构造函数。如果重写了父类的构造函数，还需要调用父类的构造函数，则通过<code>super()</code>方式调用。</p>
<p><strong>super() 在 python2、3中的区别</strong>：</p>
<p>Python3.x 和 Python2.x 的一个区别: Python 3 可以使用直接使用
super().xxx 代替 super(Class, self).xxx :</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scss">python3 直接写成 ： super()<span class="hljs-selector-class">.__init__</span>()<br>python2 必须写成 ：super(本类名,self)<span class="hljs-selector-class">.__init__</span>()<br></code></pre></td></tr></table></figure>
<p>Python3.x中的重写例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>(<span class="hljs-title class_ inherited__">object</span>):<br>     <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">self, x</span>):<br>         y = x+<span class="hljs-number">1</span><br>         <span class="hljs-built_in">print</span>(y)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span>(<span class="hljs-title class_ inherited__">A</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">self, x</span>):  <span class="hljs-comment">#重写父类方法</span><br>        <span class="hljs-built_in">super</span>().add(x)  <span class="hljs-comment">#调用父类方法</span><br>b = B()<br>b.add(<span class="hljs-number">2</span>)  <span class="hljs-comment"># 3</span><br></code></pre></td></tr></table></figure>
<p>python2.x中的重写例子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python</span><br><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>(<span class="hljs-title class_ inherited__">object</span>):   <span class="hljs-comment"># Python2.x 记得继承 object</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">self, x</span>):<br>         y = x+<span class="hljs-number">1</span><br>         <span class="hljs-built_in">print</span>(y)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span>(<span class="hljs-title class_ inherited__">A</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">self, x</span>): <span class="hljs-comment">#重写父类方法</span><br>        <span class="hljs-built_in">super</span>(B, self).add(x) <span class="hljs-comment">#调用父类方法</span><br>b = B()<br>b.add(<span class="hljs-number">2</span>)  <span class="hljs-comment"># 3</span><br><br></code></pre></td></tr></table></figure>
<h5 id="类的多态">类的多态</h5>
<p>类的多态指对不同类型的变量进行相同的操作，它会根据对象（或类）类型的不同而表现出不同的行为。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):<br>        self.name = name<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">printUser</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hello !&#x27;</span> + self.name)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserVip</span>(<span class="hljs-title class_ inherited__">User</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">printUser</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hello ! 尊敬的Vip用户：&#x27;</span> + self.name)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserGeneral</span>(<span class="hljs-title class_ inherited__">User</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">printUser</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hello ! 尊敬的用户：&#x27;</span> + self.name)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">printUserInfo</span>(<span class="hljs-params">user</span>):<br>    user.printUser()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    userVip = UserVip(<span class="hljs-string">&#x27;VIP&#x27;</span>)<br>    printUserInfo(userVip)<br>    userGeneral = UserGeneral(<span class="hljs-string">&#x27;普通用户&#x27;</span>)<br>    printUserInfo(userGeneral)<br><br></code></pre></td></tr></table></figure>
<p>输出</p>
<blockquote>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">&gt;Hello ! 尊敬的Vip用户：VIP<br>&gt;Hello ! 尊敬的用户：普通用户<br></code></pre></td></tr></table></figure>
</blockquote>
<p>从输出可以看到 根据对象的不同调用不同的实例方法。</p>
<h5 id="重载与重写">重载与重写</h5>
<p><strong>重写</strong>
子类对父类的允许访问的方法的实现过程进行重新编写,
返回值和形参都不能改变。</p>
<p><strong>优点：</strong>子类可以根据需要，定义特定于自己的行为。也就是说子类能够根据需要实现父类的方法。</p>
<p><strong>重载</strong>(overloading)
是在一个类里面，方法名字相同，而参数不同。返回类型可以相同也可以不同。每个重载的方法（或者构造函数）都必须有一个独一无二的参数类型列表。</p>
<p>*重载与重写的区别**</p>
<ol type="1">
<li>方法重载是一个类中定义了多个方法名相同，而他们的参数的数量不同或数量相同而类型和次序不同，则称为方法的重载。</li>
<li>方法重写是在子类存在方法与父类的方法的名字相同，而且参数的个数与类型一样，返回值也一样的方法，就称为重写。</li>
<li>方法重载是一个类的多态性表现，而方法重写是子类与父类的一种多态性表现。</li>
</ol>
<h5 id="类的封装">类的封装</h5>
<p>创建一个类，实际上是将具有特定属性或功能的数据或方法，“打包”定义到一个模块中，供我们需要时调用它们。这个打包的行为，我们也称“类的封装”。</p>
<p>如何管理和使用被封装在类中的属性或者方法，就需用到类的访问控制。</p>
<h5 id="类的访问控制">类的访问控制</h5>
<p><strong>属性的访问控制</strong></p>
<p>在python中，一般情况下，会使用 <code>__private_attrs</code>
两个下划线开头，声明该属性为私有，不能在类地外部被使用或直接访问。在类内部的方法中使用时
<code>self.__private_attrs</code>。</p>
<p>实际上， Python 中是没有提供私有属性等功能的。Python
对属性的访问控制是靠程序员自觉的。</p>
<p><strong>方法的访问控制</strong></p>
<p>方法的访问控制也是跟属性是一样的，也是没有实质上的私有方法。一切都是靠程序员自觉遵守
Python 的编程规范，具体规则也是跟属性一样的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, age, account</span>):<br>        self.name = name<br>        self._age = age<br>        self.__account = account <span class="hljs-comment">#私有属性</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">upgrade</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_buy_equipment</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__pk</span>(<span class="hljs-params">self</span>): <span class="hljs-comment"># 私有方法</span><br>        <span class="hljs-keyword">pass</span><br><br></code></pre></td></tr></table></figure>
<h5 id="类专有的方法">类专有的方法</h5>
<table>
<thead>
<tr class="header">
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>__init__</code></td>
<td>构造函数，在生成对象时调用</td>
</tr>
<tr class="even">
<td><code>__del__</code></td>
<td>析构函数，释放对象时使用</td>
</tr>
<tr class="odd">
<td><code>__repr__</code></td>
<td>打印，转换</td>
</tr>
<tr class="even">
<td><code>__setitem__</code></td>
<td>按照索引赋值</td>
</tr>
<tr class="odd">
<td><code>__getitem__</code></td>
<td>按照索引获取值</td>
</tr>
<tr class="even">
<td><code>__len__</code></td>
<td>获得长度</td>
</tr>
<tr class="odd">
<td><code>__cmp__</code></td>
<td>比较运算</td>
</tr>
<tr class="even">
<td><code>__call__</code></td>
<td>函数调用</td>
</tr>
<tr class="odd">
<td><code>__add__</code></td>
<td>加运算</td>
</tr>
<tr class="even">
<td><code>__sub__</code></td>
<td>减运算</td>
</tr>
<tr class="odd">
<td><code>__mul__</code></td>
<td>乘运算</td>
</tr>
<tr class="even">
<td><code>__div__</code></td>
<td>除运算</td>
</tr>
<tr class="odd">
<td><code>__mod__</code></td>
<td>求余运算</td>
</tr>
<tr class="even">
<td><code>__pow__</code></td>
<td>乘方</td>
</tr>
</tbody>
</table>
<p>需要获取类的相关信息，我们可以使用如下的方法：</p>
<ul>
<li><code>type(obj)</code>：来获取对象的相应类型；</li>
<li><code>isinstance(obj, type)</code>：判断对象是否为指定的 type
类型的实例；</li>
<li><code>hasattr(obj, attr)</code>：判断对象是否具有指定属性/方法；</li>
<li><code>getattr(obj, attr[, default])</code> 获取属性/方法的值,
要是没有对应的属性则返回 default 值（前提是设置了 default），否则会抛出
AttributeError 异常；</li>
<li><code>setattr(obj, attr, value)</code>：设定该属性/方法的值，类似于
obj.attr=value；</li>
<li><code>dir(obj)</code>：可以获取相应对象的所有属性和方法名的列表：</li>
</ul>
<h3 id="闭包与装饰器">闭包与装饰器</h3>
<h5 id="闭包">闭包</h5>
<p><strong>闭包</strong>是指一个函数可以记住其外部变量并可以访问这些变量。</p>
<p>举个例子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">num</span>):<br>    <span class="hljs-built_in">sum</span> = <span class="hljs-built_in">sum</span> + num<br>    <span class="hljs-keyword">return</span>  <span class="hljs-built_in">sum</span><br><br><span class="hljs-built_in">print</span>(add(<span class="hljs-number">2</span>)) <span class="hljs-comment">#报错 UnboundLocalError: cannot access local variable &#x27;sum&#x27; where it is not associated with a value</span><br><span class="hljs-built_in">print</span>(add(<span class="hljs-number">10</span>)) <br></code></pre></td></tr></table></figure>
<p>比如要做一个求和，第7行会报错。因为，在 Python
中，如果一个函数使用了和全局变量相同的名字且改变了该变量的值，那么该变量就会变成局部变量，那么就会造成在函数中我们没有进行定义就引用了，所以会报该错误。</p>
<p>如果要引用全局变量，并在函数中对它进行修改，请使用global关键字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">num</span>):<br>    <span class="hljs-keyword">global</span> <span class="hljs-built_in">sum</span><br>    <span class="hljs-built_in">sum</span> = <span class="hljs-built_in">sum</span> + num<br>    <span class="hljs-keyword">return</span>  <span class="hljs-built_in">sum</span><br><br><span class="hljs-built_in">print</span>(add(<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(add(<span class="hljs-number">10</span>))<br></code></pre></td></tr></table></figure>
<p>输出:</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">2</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">12</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>使用全局变量的缺点
：不同模块，不同函数都可以自由的访问全局变量，可能会造成全局变量的不可预知性。</p>
<p>可是使用<strong>闭包</strong>来解决。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_num</span>(<span class="hljs-params"><span class="hljs-built_in">sum</span></span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">num</span>):<br>        <span class="hljs-keyword">nonlocal</span> <span class="hljs-built_in">sum</span><br>        <span class="hljs-built_in">sum</span> = <span class="hljs-built_in">sum</span> + num<br>        <span class="hljs-keyword">return</span>  <span class="hljs-built_in">sum</span><br>    <span class="hljs-keyword">return</span> add<br><br>func = add_num(<span class="hljs-built_in">sum</span>)<br><span class="hljs-built_in">print</span>(func.__closure__) <br><span class="hljs-built_in">print</span>(func(<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>)<br><span class="hljs-built_in">print</span>(func(<span class="hljs-number">10</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>)<br></code></pre></td></tr></table></figure>
<p>输出</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">(&lt;cell at 0x7f8c1d5d9480: int object at 0x94f1e8&gt;,)</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">2</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">0</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">12</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">0</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>在这段代码中，add_sum中 嵌套了一个函数add,
add通过nonlocal关键字访问外部变量(add_sum的参数)sum，而最外层的sum变量并没有受到影响（依旧为0）。</p>
<p>在这里可以把global和nonlocal做一个区分：</p>
<p>两个关键词都用于允许在一个局部作用域中使用外层的变量。</p>
<ul>
<li>global 表示将变量声明为全局变量</li>
<li>nonlocal
表示将变量声明为外层变量（外层函数的局部变量，而且不能是全局变量）</li>
<li>在使用 nonlocal a 之前，必须保证外层的确已经定义过 a 了，但是在
global a
的时候，可以允许全局变量中还没有定义过a，可以留在后面定义。</li>
</ul>
<p>python 在访问一个变量时，先要去定位这个变量来源于哪里。</p>
<p>python引用变量的顺序如下：</p>
<ol type="1">
<li>当前作用域局部变量</li>
<li>外层作用域变量</li>
<li>当前模块中的全局变量</li>
<li>python内置变量</li>
</ol>
<p>即优先从局部作用域中查找这个变量，如果没有的话，再去外层找，如果到了最后还没找到，则报错。</p>
<p>这种内部函数的局部作用域中可以访问外部函数局部作用域中变量的行为，我们称为：
闭包。更加直接的表达方式就是，当某个函数被当成对象返回时，夹带了外部变量，就形成了一个闭包。所有函数都有一个
<code>__closure__</code> 属性，如果函数是闭包的话，那么它返回的是一个由
cell 组成的元组对象。cell 对象的 cell_contents
属性就是存储在闭包中的变量。如上面 的代码
print(func.<code>__closure__</code> ) ，则可以得到输出 (&lt;cell at
0x7f8c1d5d9480: int object at 0x94f1e8&gt;,)</p>
<h5 id="装饰器">装饰器</h5>
<p><strong>装饰器</strong>是修改其他函数的功能的函数。装饰器的实现就可以通过闭包来实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;简单函数&#x27;</span>)<br>func()<br></code></pre></td></tr></table></figure>
<p>给这个简单的函数加点东西，比如输出时间。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(time.strftime(<span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>, time.localtime(time.time())))  <span class="hljs-comment"># 输出时间</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;简单函数&#x27;</span>)<br>func()<br></code></pre></td></tr></table></figure>
<p>在原来的基础上修改可以达到要求，但是不符合开闭原则（对扩展开放,
对修改封闭），那么可以修改为如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;简单函数&#x27;</span>)<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">new_func</span>():<br>  	<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;新函数&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_time</span>(<span class="hljs-params">func</span>):<br>    <span class="hljs-built_in">print</span>(time.strftime(<span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>, time.localtime(time.time())))<br>    func()<br><br>add_time(func)<br>add_time(new_func)<br></code></pre></td></tr></table></figure>
<p>通过添加add_time(func)这个功能函数，可以为任意的函数添加输出时间的功能。</p>
<p>这种方式虽然可以满足要求，但是写法上不好判断是哪个函数装饰哪个函数，有没有更好的写法呢?是有的，这个写法和闭包的写法有点相似。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment">#装饰函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_time</span>():<br>        <span class="hljs-built_in">print</span>(time.strftime(<span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>, time.localtime(time.time())))<br>        func() <br>    <span class="hljs-keyword">return</span> add_time<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;简单函数&#x27;</span>)<br><br>f = decorator(func) <span class="hljs-comment"># 返回的函数对象</span><br>f()  <span class="hljs-comment"># 使用返回的函数对象调用函数</span><br></code></pre></td></tr></table></figure>
<p>在这段代码中，把add_time作为装饰函数的内部函数，把待装饰的函数传入装饰函数，并返回一个装饰的函数对象，通过调用这个返回的函数对象，就可以实现以上代码的功能，这中写法更简洁。</p>
<p>通过代码，能知道装饰器函数一般做这三件事：</p>
<ol type="1">
<li>接收一个函数作为参数</li>
<li>嵌套一个包装函数,
包装函数会接收原函数的相同参数，并执行原函数，且还会执行附加功能</li>
<li>返回嵌套函数。</li>
</ol>
<p>当然，有了装饰器函数， Python 设计出了 <code>@</code> 语法糖，让
定义装饰器，把装饰器调用原函数再把结果赋值为原函数的对象名的过程变得更加简单，方便，易操作，所以
Python
装饰器的核心可以说就是它的语法糖。使用了语法糖的装饰器用法，有点像java中的注解。把上面的代码改为使用<code>@</code>
语法糖的写法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment">#装饰函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_time</span>():<br>        <span class="hljs-built_in">print</span>(time.strftime(<span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>, time.localtime(time.time())))<br>        func() <br>    <span class="hljs-keyword">return</span> add_time<br><br><span class="hljs-meta">@decorator  </span><span class="hljs-comment">#将装饰函数加到待装饰的函数上面，就可以为待装饰函数增添新的功能。</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;简单函数&#x27;</span>)<br><br>func()<br></code></pre></td></tr></table></figure>
<p>通过使用<code>@</code>语法糖，将装饰函数加到待装饰的函数上面，就可以为待装饰函数增添新的功能。而且调用方式也与
正常的调用方式保持一致，不需要通过函数对象的方式调用了。</p>
<h6 id="python内置的装饰器">python内置的装饰器</h6>
<table>

<thead>
<tr class="header">
<th>装饰器</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="citation" data-cites="lru_cache">@lru_cache</span></td>
<td>使用缓存技巧加速</td>
</tr>
<tr class="even">
<td><span class="citation"
data-cites="total_ordering">@total_ordering</span></td>
<td>根据定义的方法为 Python 类生成缺少的比较方法。</td>
</tr>
<tr class="odd">
<td><span class="citation"
data-cites="contextmanager">@contextmanager</span></td>
<td>Python 有一个上下文管理器机制来帮助你正确地管理资源。</td>
</tr>
<tr class="even">
<td><span class="citation" data-cites="property">@property</span></td>
<td>使用 <span class="citation" data-cites="property">@property</span>
装饰器可以设置每个类属性的getter和setter方法。</td>
</tr>
<tr class="odd">
<td><span class="citation"
data-cites="cached_property">@cached_property</span></td>
<td>Python 3.8 为 functool 模块引入了一个新的强大装饰器——<span
class="citation"
data-cites="cached_property">@cached_property</span>。它可以将一个类的方法转换为一个属性，该属性的值计算一次，然后在实例的生命周期内作为普通属性缓存。</td>
</tr>
<tr class="even">
<td><span class="citation"
data-cites="classmethod">@classmethod</span></td>
<td>要定义一个类方法，我们需要使用@classmethod 装饰器。</td>
</tr>
<tr class="odd">
<td><span class="citation"
data-cites="staticmethod">@staticmethod</span></td>
<td>要定义一个静态方法，我们只需要使用@staticmethod 装饰器</td>
</tr>
<tr class="even">
<td><span class="citation" data-cites="dataclass">@dataclass</span></td>
<td><span class="citation"
data-cites="dataclass装饰器">@dataclass装饰器</span>（Python
3.7引入）可以自动为一个类生成几个特殊的方法，如<strong>init</strong>、<strong>repr</strong>、<strong>eq</strong>、<strong>lt</strong>等。</td>
</tr>
<tr class="odd">
<td><span class="citation"
data-cites="atexit.register">@atexit.register</span></td>
<td>来自 atexit 模块的 <span class="citation"
data-cites="register">@register</span> 装饰器可以让我们在 Python
解释器退出时执行一个函数。</td>
</tr>
</tbody>
</table>
<p>具体请参考这里的<a
target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2210650">示例</a></p>
<h3 id="进程与线程">进程与线程</h3>
<p>进程是操作系统进行资源分配的最小单元，线程是操作系统进行运算调度的最小单元。</p>
<p>进程一般由程序、数据集合和进程控制块三部分组成：</p>
<ul>
<li>程序用于描述进程要完成的功能，是控制进程执行的指令集</li>
<li>数据集合是程序在执行时所需要的数据和工作区</li>
<li>程序控制块，包含进程的描述信息和控制信息，是进程存在的唯一标志</li>
</ul>
<p><strong>区别</strong></p>
<ul>
<li><strong>本质区别</strong>：进程是操作系统资源分配的基本单位，而线程是任务调度和执行的基本单位</li>
<li><strong>从属关系不同</strong>:进程中包含了线程，线程属于进程。一个进程可以有很多线程，每条线程并行执行不同的任务。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。</li>
<li><strong>开销不同</strong>：进程的创建、销毁和切换的开销都远大于线程。由于线程比进程更小，基本上不拥有系统资源，故对它的调度所付出的开销就会小得多，能更高效的提高系统内多个程序间并发执行的程度，从而显著提高系统资源的利用率和吞吐量。</li>
<li><strong>拥有资源不同</strong>：每个进程有自己的内存和资源，一个进程中的线程会共享这些内存和资源。进程是资源分配的基本单位。所有与该进程有关的资源，都被记录在进程控制块PCB中。以表示该进程拥有这些资源或正在使用它们。另外，进程也是抢占处理机的调度单位，它拥有一个完整的虚拟地址空间。当进程发生调度时，不同的进程拥有不同的虚拟地址空间，而同一进程内的不同线程共享同一地址空间。</li>
<li><strong>控制和影响能力不同</strong>：子进程无法影响父进程，而子线程可以影响父线程，如果主线程发生异常会影响其所在进程和子线程。与进程相对应，线程与资源分配无关，它属于某一个进程，并与进程内的其他线程一起共享进程的资源。</li>
<li><strong>CPU利用率不同</strong>：进程的CPU利用率较低，因为上下文切换开销较大，而线程的CPU的利用率较高，上下文的切换速度快。在多核或多CPU，或支持Hyper-threading的CPU上使用多线程程序设计的好处是显而易见，即提高了程序的执行吞吐率。在单CPU单核的计算机上，使用多线程技术，也可以把进程中负责I/O处理、人机交互而常被阻塞的部分与密集计算的部分分开来执行，编写专门的workhorse线程执行密集计算，从而提高了程序的执行效率。</li>
</ul>
<h5 id="python的多线程">Python的多线程</h5>
<p>线程的状态可以分为</p>
<ul>
<li>New 创建</li>
<li>Runnable 就绪。等待调度</li>
<li>Running 运行</li>
<li>Blocked 阻塞。阻塞可能在 Wait Locked Sleeping</li>
<li>Dead 消亡</li>
</ul>
<p>线程的类型可分为：</p>
<ul>
<li>主线程</li>
<li>子线程</li>
<li>守护线程（后台线程）</li>
<li>前台线程</li>
</ul>
<p>Python 提供两个模块进行多线程的操作，分别是 <code>thread</code> 和
<code>threading</code></p>
<p>Thread是比较低级的模块，用于更底层的操作。因此，主要用threading多一些。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> threading<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubThread</span>(threading.Thread):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;thread &#123;&#125;, @number: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(self.name, i))<br>            time.sleep(<span class="hljs-number">1</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Start main threading&quot;</span>)<br><br>    <span class="hljs-comment"># 创建三个线程</span><br>    threads = [SubThread() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>    <span class="hljs-comment"># 启动三个线程</span><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>        t.start()<br>    <span class="hljs-comment"># 让新创建的线程执行 join,等待子线程执行</span><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>        t.join()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;End Main threading&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure>
<h5 id="线程同步">线程同步</h5>
<p>多线程会造成数据不同步的问题，在这种情况下，就要使用锁机制。python
Threading模块提供了Lock功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">lock = threading.Lock()<br>lock.acquire()<br>lock.release()<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> threading<br><br>shared_resource_lock = threading.Lock()<br><span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubThread</span>(threading.Thread):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, threadname, startnum, endnum</span>):<br>        threading.Thread.__init__(self)<br>        self._threadname = threadname<br>        self._startnum = startnum<br>        self._endnum = endnum<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">global</span> <span class="hljs-built_in">sum</span><br>        shared_resource_lock.acquire() <span class="hljs-comment">#加锁</span><br>        <span class="hljs-comment"># print(self._startnum, self._endnum)</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self._startnum, self._endnum+<span class="hljs-number">1</span>):<br>            <span class="hljs-comment"># print(i)</span><br>            <span class="hljs-built_in">sum</span> = <span class="hljs-built_in">sum</span> + i<br>            time.sleep(<span class="hljs-number">0.1</span>)<br>        <span class="hljs-built_in">print</span>(self._threadname,<span class="hljs-string">&quot;计算结果&quot;</span>,<span class="hljs-built_in">sum</span>)<br>        shared_resource_lock.release() <span class="hljs-comment"># 释放锁</span><br>    <br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Start main threading&quot;</span>)<br><br>    <span class="hljs-comment"># 创建三个线程</span><br>    threads = [SubThread(<span class="hljs-string">&quot;线程&quot;</span>+<span class="hljs-built_in">str</span>(i), i*<span class="hljs-number">20</span>+<span class="hljs-number">1</span>, (i+<span class="hljs-number">1</span>)*<span class="hljs-number">20</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br>    <span class="hljs-comment"># 启动三个线程</span><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>        t.start()<br><br>   <span class="hljs-comment"># 一次让新创建的线程执行 join</span><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>        t.join()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;End Main threading&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure>
<p>输出:</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">Start main threading</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">线程0 计算结果 210</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">线程1 计算结果 820</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">线程2 计算结果 1830</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">线程3 计算结果 3240</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">线程4 计算结果 5050</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">End Main threading</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>这段代码展示了使用多线程从1到100的求和。5个线程，每个线程负责20个数，最后得到5050的求和结果。为了保证求和的顺利进行，全局变量
<code>sum</code>是共享的，所以需要通过加锁保证计算的正确性。</p>
<h5 id="线程同步的其他方式">线程同步的其他方式</h5>
<h6 id="可重入锁">可重入锁</h6>
<p>支持在同一线程中多次请求同一资源，Python
提供了可重入锁（RLock）。RLock 内部维护着一个 Lock 和一个 counter
变量，counter 记录了 acquire 的次数，从而使得资源可以被多次
require。直到一个线程所有的 acquire 都被
release，其他的线程才能获得资源。</p>
<p>r_lock = threading.RLock()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Box</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    lock = threading.RLock() <span class="hljs-comment"># 可重入锁</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.total_items = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, n</span>):<br>        Box.lock.acquire()<br>        self.total_items += n<br>        Box.lock.release()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">self</span>):<br>        Box.lock.acquire()<br>        self.execute(<span class="hljs-number">1</span>)<br>        Box.lock.release()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">remove</span>(<span class="hljs-params">self</span>):<br>        Box.lock.acquire()<br>        self.execute(-<span class="hljs-number">1</span>)<br>        Box.lock.release()<br><br><span class="hljs-comment">## These two functions run n in separate</span><br><span class="hljs-comment">## threads and call the Box&#x27;s methods</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">adder</span>(<span class="hljs-params">box, items</span>):<br>    <span class="hljs-keyword">while</span> items &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;adding 1 item in the box&quot;</span>)<br>        box.add()<br>        time.sleep(<span class="hljs-number">1</span>)<br>        items -= <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remover</span>(<span class="hljs-params">box, items</span>):<br>    <span class="hljs-keyword">while</span> items &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;removing 1 item in the box&quot;</span>)<br>        box.remove()<br>        time.sleep(<span class="hljs-number">1</span>)<br>        items -= <span class="hljs-number">1</span><br><br><span class="hljs-comment">## the main program build some</span><br><span class="hljs-comment">## threads and make sure it works</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    items = <span class="hljs-number">5</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;putting %s items in the box &quot;</span> % items)<br>    box = Box()<br>    t1 = threading.Thread(target=adder, args=(box, items))<br>    t2 = threading.Thread(target=remover, args=(box, items))<br>    t1.start()<br>    t2.start()<br><br>    t1.join()<br>    t2.join()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s items still remain in the box &quot;</span> % box.total_items)<br></code></pre></td></tr></table></figure>
<h6 id="信号量">信号量</h6>
<p>使用 semaphore = threading.Semaphore(0) 定义信号量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-string">&quot;&quot;&quot;Using a Semaphore to synchronize threads&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-comment"># The optional argument gives the initial value for the internal</span><br><span class="hljs-comment"># counter;</span><br><span class="hljs-comment"># it defaults to 1.</span><br><span class="hljs-comment"># If the value given is less than 0, ValueError is raised.</span><br>semaphore = threading.Semaphore(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">consumer</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;consumer is waiting.&quot;</span>)<br>        <span class="hljs-comment"># Acquire a semaphore</span><br>        semaphore.acquire()<br>        <span class="hljs-comment"># The consumer have access to the shared resource</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Consumer notify : consumed item number %s &quot;</span> % item)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">producer</span>():<br>        <span class="hljs-keyword">global</span> item<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        <span class="hljs-comment"># create a random item</span><br>        item = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;producer notify : produced item number %s&quot;</span> % item)<br>         <span class="hljs-comment"># Release a semaphore, incrementing the internal counter by one.</span><br>        <span class="hljs-comment"># When it is zero on entry and another thread is waiting for it</span><br>        <span class="hljs-comment"># to become larger than zero again, wake up that thread.</span><br>        semaphore.release()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,<span class="hljs-number">5</span>) :<br>                t1 = threading.Thread(target=producer)<br>                t2 = threading.Thread(target=consumer)<br>                t1.start()<br>                t2.start()<br>                t1.join()<br>                t2.join()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;program terminated&quot;</span>)<br></code></pre></td></tr></table></figure>
<h6 id="条件">条件</h6>
<p>condition = Condition()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread, Condition<br><span class="hljs-keyword">import</span> time<br><br>items = []<br>condition = Condition()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">consumer</span>(<span class="hljs-title class_ inherited__">Thread</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        Thread.__init__(self)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">consume</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">global</span> condition<br>        <span class="hljs-keyword">global</span> items<br>        condition.acquire()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(items) == <span class="hljs-number">0</span>:<br>            condition.wait()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Consumer notify : no item to consume&quot;</span>)<br>        items.pop()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Consumer notify : consumed 1 item&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Consumer notify : items to consume are &quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(items)))<br><br>        condition.notify()<br>        condition.release()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>):<br>            time.sleep(<span class="hljs-number">2</span>)<br>            self.consume()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">producer</span>(<span class="hljs-title class_ inherited__">Thread</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        Thread.__init__(self)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">produce</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">global</span> condition<br>        <span class="hljs-keyword">global</span> items<br>        condition.acquire()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(items) == <span class="hljs-number">10</span>:<br>            condition.wait()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Producer notify : items producted are &quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(items)))<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Producer notify : stop the production!!&quot;</span>)<br>        items.append(<span class="hljs-number">1</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Producer notify : total items producted &quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(items)))<br>        condition.notify()<br>        condition.release()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>):<br>            time.sleep(<span class="hljs-number">1</span>)<br>            self.produce()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    producer = producer()<br>    consumer = consumer()<br>    producer.start()<br>    consumer.start()<br>    producer.join()<br>    consumer.join()<br></code></pre></td></tr></table></figure>
<h6 id="事件">事件</h6>
<p>Python 还提供了 Event
对象用于线程间通信，它是由线程设置的信号标志，如果信号标志位真，则其他线程等待直到信号接触。</p>
<p>Event
对象实现了简单的线程通信机制，它提供了设置信号，清除信号，等待等用于实现线程间的通信。</p>
<ul>
<li>设置信号</li>
</ul>
<p>使用 Event 的 <code>set()</code> 方法可以设置 Event
对象内部的信号标志为真。Event 对象提供了 <code>isSet()</code>
方法来判断其内部信号标志的状态。当使用 event 对象的 <code>set()</code>
方法后，<code>isSet()</code> 方法返回真</p>
<ul>
<li>清除信号</li>
</ul>
<p>使用 Event 对象的 <code>clear()</code> 方法可以清除 Event
对象内部的信号标志，即将其设为假，当使用 Event 的 clear 方法后，isSet()
方法返回假</p>
<ul>
<li>等待</li>
</ul>
<p>Event 对象 wait
的方法只有在内部信号为真的时候才会很快的执行并完成返回。当 Event
对象的内部信号标志位假时，则 wait 方法一直等待到其为真时才返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread, Event<br><span class="hljs-keyword">import</span> random<br>items = []<br>event = Event()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">consumer</span>(<span class="hljs-title class_ inherited__">Thread</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, items, event</span>):<br>        Thread.__init__(self)<br>        self.items = items<br>        self.event = event<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            time.sleep(<span class="hljs-number">2</span>)<br>            self.event.wait()<br>            item = self.items.pop()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Consumer notify : %d popped from list by %s&#x27;</span> % (item, self.name))<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">producer</span>(<span class="hljs-title class_ inherited__">Thread</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, items, event</span>):<br>        Thread.__init__(self)<br>        self.items = items<br>        self.event = event<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">global</span> item<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>            time.sleep(<span class="hljs-number">2</span>)<br>            item = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">256</span>)<br>            self.items.append(item)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Producer notify : item N° %d appended to list by %s&#x27;</span> % (item, self.name))<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Producer notify : event set by %s&#x27;</span> % self.name)<br>            self.event.<span class="hljs-built_in">set</span>()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Produce notify : event cleared by %s &#x27;</span>% self.name)<br>            self.event.clear()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    t1 = producer(items, event)<br>    t2 = consumer(items, event)<br>    t1.start()<br>    t2.start()<br>    t1.join()<br>    t2.join()<br></code></pre></td></tr></table></figure>
<h5 id="python的多进程">python的多进程</h5>
<p>Python 中的多线程其实并不是真正的多线程，如果想要充分地使用多核 CPU
的资源，在 Python 中大部分情况需要使用多进程。</p>
<p>Python 提供了非常好用的多进程包
multiprocessing，只需要定义一个函数，Python 会完成其他所有事情。</p>
<p>借助这个包，可以轻松完成从单进程到并发执行的转换。multiprocessing
支持子进程、通信和共享数据、执行不同形式的同步，提供了
Process、Queue、Pipe、Lock 等组件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> multiprocessing<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">i</span>):<br>    <span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;called function in process: %s&#x27;</span> %i)<br>    <span class="hljs-keyword">return</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    Process_jobs = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        p = multiprocessing.Process(target=foo, args=(i,))<br>        Process_jobs.append(p)<br>        p.start()<br>        p.join()<br></code></pre></td></tr></table></figure>
<p>创建进程的类：<code>Process([group [, target [, name [, args [, kwargs]]]]])</code></p>
<ul>
<li>target 表示调用对象</li>
<li>args 表示调用对象的位置参数元组</li>
<li>kwargs表示调用对象的字典</li>
<li>name为别名</li>
<li>group实质上不使用</li>
</ul>
<h6 id="使用类的形式创建进程">使用类的形式创建进程</h6>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><br><span class="hljs-keyword">import</span> multiprocessing<br><span class="hljs-keyword">import</span> time<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClockProcess</span>(multiprocessing.Process):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, interval</span>):<br>        multiprocessing.Process.__init__(self)<br>        self.interval = interval<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        n = <span class="hljs-number">5</span><br>        <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;当前时间: &#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(time.ctime()))<br>            time.sleep(self.interval)<br>            n -= <span class="hljs-number">1</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    p = ClockProcess(<span class="hljs-number">3</span>)<br>    p.start()<br><br></code></pre></td></tr></table></figure>
<h6 id="进程池">进程池</h6>
<p>因为进程的创建和销毁都需要消耗资源，可以使用进程池的方法批量创建子进程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool<br><span class="hljs-keyword">import</span> os, time, random<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">long_time_task</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;进程的名称：&#123;0&#125; ；进程的PID: &#123;1&#125; &#x27;</span>.<span class="hljs-built_in">format</span>(name, os.getpid()))<br>    start = time.time()<br>    time.sleep(random.random() * <span class="hljs-number">3</span>)<br>    end = time.time()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;进程 &#123;0&#125; 运行了 &#123;1&#125; 秒&#x27;</span>.<span class="hljs-built_in">format</span>(name, (end - start)))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;主进程的 PID：&#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(os.getpid()))<br>    p = Pool(<span class="hljs-number">4</span>)  <span class="hljs-comment"># 进程池</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        p.apply_async(long_time_task, args=(i,))<br>    p.close()<br>    <span class="hljs-comment"># 等待所有子进程结束后在关闭主进程</span><br>    p.join()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;【End】&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h6 id="后台进程">后台进程</h6>
<p>如果需要处理比较巨大的任务，又不需要人为干预，将其作为后台进程执行是个非常常用的编程模型。此进程又可以和其他进程并发执行。通过Python的multiprocessing模块的后台进程选项，我们可以让进程在后台运行。</p>
<p>为了在后台运行进程，我们设置 <code>daemon</code> 参数为
<code>True</code></p>
<p><strong>注意</strong> :
后台进程不允许创建子进程。否则，当后台进程跟随父进程退出的时候，子进程会变成孤儿进程。另外，它们并不是Unix的守护进程或服务（daemons
or
services），所以当非后台进程退出，它们会被终结。后台运行进程在主进程结束之后会自动结束。</p>
<p>更过关于python并行编程的内容请参考<a
target="_blank" rel="noopener" href="https://python-parallel-programmning-cookbook.readthedocs.io/zh-cn/latest/chapter2/index.html">这里</a>,
<a
target="_blank" rel="noopener" href="https://github.com/walter201230/Python/tree/master">教程</a></p>
<h3 id="模块与包">模块与包</h3>
<h6 id="模块">模块</h6>
<p><strong>在 Python 中，一个 .py
文件就称之为一个模块（Module）。</strong></p>
<p>模块的好处：</p>
<ul>
<li>提高了代码的可维护性</li>
<li>可以避免函数名和变量名冲突</li>
</ul>
<p>使用模块的方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> module1[, module2[,... moduleN]<br><br><span class="hljs-comment"># from 后的参数可以为包路径，也可以为模块名路径，并且可以精确指定 import 模块中各成员。</span><br><span class="hljs-keyword">from</span> modname <span class="hljs-keyword">import</span> name1[, name2[, ... nameN]]<br><br><span class="hljs-keyword">from</span> modname <span class="hljs-keyword">import</span> *<br></code></pre></td></tr></table></figure>
<p>主模块和非主模块</p>
<p>在 Python
中，有主模块和非主模块之分，如果一个模块被直接使用，而没有被别人调用，我们称这个模块为主模块，如果一个模块被别人调用，我们称这个模块为非主模块。</p>
<p><code>__name__</code>
属性值是一个变量，且这个变量是系统给出的。利用这个变量可以判断一个模块是否是主模块。这个属性不能决定他们是否是主模块，决定是否是主模块的条件只是这个模块有没有被人调用。</p>
<h6 id="包">包</h6>
<p>为了避免模块名冲突，Python
又引入了按目录来组织模块的方法，称为包（Package）。</p>
<p>简单说包就是一个文件夹，这个文件夹包含一个 <code>__init__.py</code>
文件，它可以是一个空文件。引入了包以后，只要顶层的包名不冲突，那么所有的模块都不会冲突。</p>
<p><code>__init__.py</code> 可以是空文件，也可以有Python代码，因为
<code>__init__.py</code>
本身就是一个模块，而它对应的模块名就是它的包名。</p>
<p>更多信息请参考<a
target="_blank" rel="noopener" href="https://pythonhowto.readthedocs.io/zh-cn/latest/module.html">这里</a></p>
<h6 id="作用域">作用域</h6>
<p>在 Python 中，是通过 <code>_</code>
前缀来实现的。正常的函数和变量名是公开的（public），可以被直接引用，比如：abc，ni12，PI等；类似<code>__xxx__</code>这样的变量是特殊变量，可以被直接引用，但是有特殊用途，比如上面的
<code>__name__</code> 就是特殊变量，还有 <code>__author__</code>
也是特殊变量，用来标明作者。</p>
<p>注意，我们自己的变量一般不要用这种变量名；类似 <code>_xxx</code> 和
<code>__xxx</code>
这样的函数或变量就是非公开的（private），不应该被直接引用，比如
<code>_abc</code> ，<code>__abc</code> 等；</p>
<p><strong>这里是说不应该，而不是不能。因为 Python
种并没有一种方法可以完全限制访问 private
函数或变量，但是，从编程习惯上不应该引用 private
函数或变量。</strong></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/" class="category-chain-item">计算机技术</a>
  
  
    <span>></span>
    
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" class="category-chain-item">开发语言</a>
  
  
    <span>></span>
    
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/python/" class="category-chain-item">python</a>
  
  

  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/07/26/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" title="深度学习入门">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">深度学习入门</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/07/14/hexo%E6%96%87%E7%AB%A0%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87/" title="hexo文章中插入图片">
                        <span class="hidden-mobile">hexo文章中插入图片</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
